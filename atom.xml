<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>stonecat</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://zeshawne.github.io/"/>
  <updated>2017-03-07T12:12:57.758Z</updated>
  <id>https://zeshawne.github.io/</id>
  
  <author>
    <name>stone</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>mysql explain</title>
    <link href="https://zeshawne.github.io/2016/09/10/mysql%20explain/"/>
    <id>https://zeshawne.github.io/2016/09/10/mysql explain/</id>
    <published>2016-09-10T12:01:46.000Z</published>
    <updated>2017-03-07T12:12:57.758Z</updated>
    
    <content type="html">&lt;h2 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;今日和同事一起排查一个线上慢sql,温习了遗忘好久的explain,特此记录&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;介绍&quot;&gt;&lt;a href=&quot;#介绍&quot; class=&quot;headerlink&quot; title=&quot;介绍&quot;&gt;&lt;/a&gt;介绍&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;EXPLAIN命令是查看优化器如何决定执行查询的主要方法.可以帮助我们深入了解MySQL的基于开销的优化器,还可以获得很多可能被优化器考虑到的访问策略的细节,以及当运行SQL语句时哪种策略预计会被优化器采用.需要注意的是,生成的QEP并不确定,它可能会根据很多因素发生改变.MySQL不会将一个QEP和某个给定查询绑定,QEP将由SQL语句每次执行时的实际情况确定.即便使用存储过程也是如此.尽管在存储过程中SQL语句都是预先解析过的,但QEP仍然会在每次调用存储过程的时候才被确定&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt;explain select * from (select * from ( select * from tstatistics_tags_back where id=39) a) b;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;result:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+------------+-------+---------------+---------+---------+--------+------+---------------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table      | type  | possible_keys | key     | key_len | ref    | rows | Extra                           |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+------------+-------+---------------+---------+---------+--------+------+---------------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | PRIMARY     | &amp;lt;derived2&amp;gt;            | system   | NULL          | NULL    | NULL    | NULL |    1  |     NULL    |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  2 | DERIVED     | &amp;lt;derived3&amp;gt;            | system   | NULL          |   NULL  | NULL    | NULL |    1  |     NULL    |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  3 | DERIVED     | tstatistics_tags_back | const    | PRIMARY       | PRIMARY | 4       |const |    1  |      NULL  |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+------------+-------+---------------+---------+---------+--------+------+---------------------------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;explain信息有10列,下面对这些信息进行详解&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;详解&quot;&gt;&lt;a href=&quot;#详解&quot; class=&quot;headerlink&quot; title=&quot;详解&quot;&gt;&lt;/a&gt;详解&lt;/h2&gt;&lt;h3 id=&quot;id&quot;&gt;&lt;a href=&quot;#id&quot; class=&quot;headerlink&quot; title=&quot;id&quot;&gt;&lt;/a&gt;id&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;包含一组数字,表示查询中执行select子句或操作表的顺序&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;id相同，执行顺序由上至下&lt;/li&gt;
&lt;li&gt;如果是子查询,id的序号会递增,id值越大优先级越高,越先被执行&lt;/li&gt;
&lt;li&gt;id如果相同,可以认为是一组,从上往下顺序执行;在所有组中,id值越大,优先级越高,越先执行&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;select-type&quot;&gt;&lt;a href=&quot;#select-type&quot; class=&quot;headerlink&quot; title=&quot;select_type&quot;&gt;&lt;/a&gt;select_type&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;查询中每个select子句的类型(简单OR复杂)&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;simple (SIMPLE : 简单的select,不使用union或子查询等)&lt;/li&gt;
&lt;li&gt;primary (PRIMARY : 查询中若包含任何复杂的子语句,最外层的select被标记为primary)&lt;/li&gt;
&lt;li&gt;union (UNION : union中第二个或后面的select语句)&lt;/li&gt;
&lt;li&gt;dependent union (DEPENDENT UNION : union中的第二个或后面的select语句,取决于外面的查询)&lt;/li&gt;
&lt;li&gt;union result (UNION RESULT : union的结果)&lt;/li&gt;
&lt;li&gt;subQuery (SUBQUERY : 子查询中的第一个select)&lt;/li&gt;
&lt;li&gt;dependent subQuery (DEPENDENT SUBQUERY : 子查询中第一个select,取决于外面的查询)&lt;/li&gt;
&lt;li&gt;derived (DERIVED : 派生表的select,from子句的子查询)&lt;/li&gt;
&lt;li&gt;uncacheable subQuery (UNCACHEABLE SUBQUERY : 一个子查询的结果不能被缓存,必须重新评估外连接的第一行)&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select d1.name, ( select id from t3) d2 from (select id,name from t1 where name=&amp;apos;&amp;apos;)d1 union (select name,id from t2);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;result:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+--------------+------------+--------+---------------+------+---------+------+------+--------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type  | table      | type   | possible_keys | key  | key_len | ref  | rows | Extra                    |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+--------------+------------+--------+---------------+------+---------+------+------+--------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | PRIMARY      | &amp;lt;derived3&amp;gt; | system | NULL          | NULL | NULL    | NULL |    0 | const row not found      |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  3 | DERIVED      | t1         | ref    | name          | name | 63      |      |    1 | Using where; Using index |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  2 | SUBQUERY     | t3         | index  | NULL          | age  | 5       | NULL |    6 | Using index              |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  4 | UNION        | t2         | index  | NULL          | name | 63      | NULL |    4 | Using index              |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| NULL | UNION RESULT | &amp;lt;union1,4&amp;gt; | ALL    | NULL          | NULL | NULL    | NULL | NULL |                          |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+--------------+------------+--------+---------------+------+---------+------+------+--------------------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;table&quot;&gt;&lt;a href=&quot;#table&quot; class=&quot;headerlink&quot; title=&quot;table&quot;&gt;&lt;/a&gt;table&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;显示这一行的数据是关于哪张表的&lt;/em&gt;&lt;/strong&gt;&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select * from (select * from ( select * from t1 where id=2602) a) b;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;result:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table      | type   | possible_keys     | key     | key_len | ref  | rows | Extra |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | PRIMARY     | &amp;lt;derived2&amp;gt; | system | NULL              | NULL    | NULL    | NULL |    1 |       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  2 | DERIVED     | &amp;lt;derived3&amp;gt; | system | NULL              | NULL    | NULL    | NULL |    1 |       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  3 | DERIVED     | t1         | const  | PRIMARY,idx_t1_id | PRIMARY | 4       |      |    1 |       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;type&quot;&gt;&lt;a href=&quot;#type&quot; class=&quot;headerlink&quot; title=&quot;type&quot;&gt;&lt;/a&gt;type&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;表示MySQL在表中找到所需行的方式,又称“访问类型”&lt;/em&gt;&lt;/strong&gt;&lt;br&gt; &lt;strong&gt;ALL, index, range, ref, eq_ref, const, system, NULL&lt;/strong&gt;&lt;br&gt; &lt;font color=&quot;red&quot;&gt;从左到右,性能从最差到最好&lt;/font&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;ALL&quot;&gt;&lt;a href=&quot;#ALL&quot; class=&quot;headerlink&quot; title=&quot;ALL&quot;&gt;&lt;/a&gt;ALL&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;Full Table Scan, MySQL将遍历全表以找到匹配的行&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select * from t1 where email=&amp;apos;&amp;apos;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;result:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+------+---------------+------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+------+---------------+------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | ALL  | NULL          | NULL | NULL    | NULL |    4 | Using where |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+------+---------------+------+---------+------+------+-------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;index&quot;&gt;&lt;a href=&quot;#index&quot; class=&quot;headerlink&quot; title=&quot;index&quot;&gt;&lt;/a&gt;index&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;Full Index Scan, index与ALL区别为index类型只遍历索引树&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select id from t1;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;result:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type  | possible_keys | key  | key_len | ref  | rows | Extra       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | index | NULL          | age  | 5       | NULL |    4 | Using index |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;range&quot;&gt;&lt;a href=&quot;#range&quot; class=&quot;headerlink&quot; title=&quot;range&quot;&gt;&lt;/a&gt;range&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;索引范围扫描,对索引的扫描开始于某一点,返回匹配值域的行.显而易见的索引范围扫描是带有between或者where子句里带有&amp;lt;, &amp;gt;查询.当mysql使用索引去查找一系列值时,例如IN()和OR列表,也会显示range(范围扫描),当然性能上面是有差异的.&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select * from t1 where id in (1,4);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type  | possible_keys | key     | key_len | ref  | rows | Extra       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | range | PRIMARY       | PRIMARY | 4       | NULL |    2 | Using where |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select * from t1 where id between 1 and 4;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type  | possible_keys | key     | key_len | ref  | rows | Extra       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | range | PRIMARY       | PRIMARY | 4       | NULL |    3 | Using where |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select * from t1 where id=1 or id=4;       &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type  | possible_keys | key     | key_len | ref  | rows | Extra       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | range | PRIMARY       | PRIMARY | 4       | NULL |    2 | Using where |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select * from t1 where id &amp;gt; 1;      &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type  | possible_keys | key     | key_len | ref  | rows | Extra       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | range | PRIMARY       | PRIMARY | 4       | NULL |    3 | Using where |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;ref&quot;&gt;&lt;a href=&quot;#ref&quot; class=&quot;headerlink&quot; title=&quot;ref&quot;&gt;&lt;/a&gt;ref&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;使用非唯一索引扫描或者唯一索引的前缀扫描,返回匹配某个单独值的记录行&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select t1.name from t1, t2 where t1.id=t2.id;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;result:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type   | possible_keys | key     | key_len | ref        | rows | Extra       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | index  | PRIMARY       | name    | 63      | NULL       |    4 | Using index |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t2    | eq_ref | PRIMARY       | PRIMARY | 4       | test.t1.id |    1 | Using index |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;const-system&quot;&gt;&lt;a href=&quot;#const-system&quot; class=&quot;headerlink&quot; title=&quot;const,system&quot;&gt;&lt;/a&gt;const,system&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;当MySQL对查询某部分进行优化,并转换为一个常量时,使用这些类型访问.如将主键置于where列表中,MySQL就能将该查询转换为一个常量&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select * from ( select * from t1 where id=1)b1;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;result:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+------------+--------+---------------+---------+---------+------+------+-------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table      | type   | possible_keys | key     | key_len | ref  | rows | Extra |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+------------+--------+---------------+---------+---------+------+------+-------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | PRIMARY     | &amp;lt;derived2&amp;gt; | system | NULL          | NULL    | NULL    | NULL |    1 |       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  2 | DERIVED     | t1         | const  | PRIMARY       | PRIMARY | 4       |      |    1 |       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+------------+--------+---------------+---------+---------+------+------+-------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;注:system是const类型的特例,当查询的表只有一行的情况下,使用system&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;NULL&quot;&gt;&lt;a href=&quot;#NULL&quot; class=&quot;headerlink&quot; title=&quot;NULL&quot;&gt;&lt;/a&gt;NULL&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;MySQL在优化过程中分解语句,执行时甚至不用访问表或索引,例如从一个索引列里选取最小值可以通过单独索引查找完成&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select * from t1 where id = (select min(id) from t2);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;result:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+-------+------+------------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type  | possible_keys | key     | key_len | ref   | rows | Extra                        |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+-------+------+------------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | PRIMARY     | t1    | const | PRIMARY       | PRIMARY | 4       | const |    1 |                              |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  2 | SUBQUERY    | NULL  | NULL  | NULL          | NULL    | NULL    | NULL  | NULL | Select tables optimized away |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+-------+------+------------------------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;possible-keys&quot;&gt;&lt;a href=&quot;#possible-keys&quot; class=&quot;headerlink&quot; title=&quot;possible_keys&quot;&gt;&lt;/a&gt;possible_keys&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;指出MySQL能使用哪个索引在表中找到记录,查询涉及到的字段上若存在索引,则该索引将被列出,但不一定被查询使用&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;key&quot;&gt;&lt;a href=&quot;#key&quot; class=&quot;headerlink&quot; title=&quot;key&quot;&gt;&lt;/a&gt;key&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;显示MySQL在查询中实际使用的索引，若没有使用索引，显示为NULL&lt;/em&gt;&lt;/strong&gt;&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select id,age from t1;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;result:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type  | possible_keys | key  | key_len | ref  | rows | Extra       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | index | NULL          | age  | 5       | NULL |    4 | Using index |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;key-len&quot;&gt;&lt;a href=&quot;#key-len&quot; class=&quot;headerlink&quot; title=&quot;key_len&quot;&gt;&lt;/a&gt;key_len&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;表示索引中使用的字节数,可通过该列计算查询中使用的索引的长度(key_len显示的值为索引字段的最大可能长度,并非实际使用长度,即key_len是根据表定义计算而得,不是通过表内检索出的)&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;ref-1&quot;&gt;&lt;a href=&quot;#ref-1&quot; class=&quot;headerlink&quot; title=&quot;ref&quot;&gt;&lt;/a&gt;ref&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;表示上述表的连接匹配条件,即哪些列或常量被用于查找索引列上的值&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;rows&quot;&gt;&lt;a href=&quot;#rows&quot; class=&quot;headerlink&quot; title=&quot;rows&quot;&gt;&lt;/a&gt;rows&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;表示MySQL根据表统计信息及索引选用情况,估算的找到所需的记录所需要读取的行数&lt;/em&gt;&lt;/strong&gt;&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select * from t1 , t2 where t1.id=t2.id and t2.name=&amp;apos;atlas&amp;apos;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;result:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type   | possible_keys | key     | key_len | ref        | rows | Extra       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t2    | ref    | PRIMARY,name  | name    | 63      | const      |    1 | Using where |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | eq_ref | PRIMARY       | PRIMARY | 4       | test.t2.id |    1 |             |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;extra&quot;&gt;&lt;a href=&quot;#extra&quot; class=&quot;headerlink&quot; title=&quot;extra&quot;&gt;&lt;/a&gt;extra&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;包含不适合在其他列中显示但十分重要的额外信息&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;Using-index&quot;&gt;&lt;a href=&quot;#Using-index&quot; class=&quot;headerlink&quot; title=&quot;Using index&quot;&gt;&lt;/a&gt;Using index&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;该值表示相应的select操作中使用了覆盖索引(Covering Index)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select id from t1;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;result:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type  | possible_keys | key  | key_len | ref  | rows | Extra       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | index | NULL          | age  | 5       | NULL |    4 | Using index |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;覆盖索引(Covering Index)&lt;br&gt;MySQL可以利用索引返回select列表中的字段,而不必根据索引再次读取数据文件&lt;br&gt;包含所有满足查询需要的数据的索引称为覆盖索引(Covering Index)&lt;br&gt;注意:如果要使用覆盖索引,一定要注意select列表中只取出需要的列,不可select *,因为如果将所有字段一起做索引会导致索引文件过大,查询性能下降&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;Using-where&quot;&gt;&lt;a href=&quot;#Using-where&quot; class=&quot;headerlink&quot; title=&quot;Using where&quot;&gt;&lt;/a&gt;Using where&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;表示mysql服务器将在存储引擎检索行后再进行过滤.许多where条件里涉及索引中的列,当(并且如果)它读取索引时,就能被存储引擎检验,因此不是所有带where字句的查询都会显示”Using where”.有时”Using where”的出现就是一个暗示:查询可受益与不同的索引。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select id,name from t1 where id&amp;lt;4;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;result:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+------+------+--------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type  | possible_keys | key  | key_len | ref  | rows | Extra                    |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+------+------+--------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | index | PRIMARY       | name | 63      | NULL |    4 | Using where; Using index |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+------+------+--------------------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;Using-temporary&quot;&gt;&lt;a href=&quot;#Using-temporary&quot; class=&quot;headerlink&quot; title=&quot;Using temporary&quot;&gt;&lt;/a&gt;Using temporary&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;表示MySQL需要使用临时表来存储结果集,常见于排序和分组查询&lt;/p&gt;
&lt;p&gt;这个值表示使用了内部临时(基于内存的)表.一个查询可能用到多个临时表.有很多原因都会导致MySQL在执行查询期间创建临时表.两个常见的原因是在来自不同表的上使用了DISTINCT,或者使用了不同的ORDER BY和GROUP BY列.可以强制指定一个临时表使用基于磁盘的MyISAM存储引擎.这样做的原因主要有两个:&lt;br&gt;1)内部临时表占用的空间超过min(tmp_table_size，max_heap_table_size)系统变量的限制&lt;br&gt;2)使用了TEXT/BLOB 列&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select id from t1 where id in (1,2) group by age,name;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;result:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+------+------+----------------------------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type  | possible_keys | key     | key_len | ref  | rows | Extra                                        |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+------+------+----------------------------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | range | PRIMARY       | PRIMARY | 4       | NULL |    2 | Using where; Using temporary; Using filesort |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+---------+---------+------+------+----------------------------------------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;Using-filesort&quot;&gt;&lt;a href=&quot;#Using-filesort&quot; class=&quot;headerlink&quot; title=&quot;Using filesort&quot;&gt;&lt;/a&gt;Using filesort&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;MySQL中无法利用索引完成的排序操作称为“文件排序”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select id,age from t1 order by name;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+------+---------------+------+---------+------+------+----------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra          |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+------+---------------+------+---------+------+------+----------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | ALL  | NULL          | NULL | NULL    | NULL |    4 | Using filesort |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+------+---------------+------+---------+------+------+----------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select id,age from t1 order by age;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type  | possible_keys | key  | key_len | ref  | rows | Extra       |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | index | NULL          | age  | 5       | NULL |    4 | Using index |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;Using-join-buffer&quot;&gt;&lt;a href=&quot;#Using-join-buffer&quot; class=&quot;headerlink&quot; title=&quot;Using join buffer&quot;&gt;&lt;/a&gt;Using join buffer&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;改值强调了在获取连接条件时没有使用索引,并且需要连接缓冲区来存储中间结果.如果出现了这个值,那应该注意,根据查询的具体情况可能需要添加索引来改进性能.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select t1.name from t1 inner join t2 on t1.name=t2.name;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+--------------+------+--------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type  | possible_keys | key  | key_len | ref          | rows | Extra                    |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+--------------+------+--------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | index | name          | name | 63      | NULL         |    4 | Using index              |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t2    | ref   | name          | name | 63      | test.t1.name |    2 | Using where; Using index |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+-------+---------------+------+---------+--------------+------+--------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; alter table t1 drop key name;                                   &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; alter table t2 drop key name;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select t1.name from t1 inner join t2 on t1.name=t2.name;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra                          |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t1    | ALL  | NULL          | NULL | NULL    | NULL |    4 |                                |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | t2    | ALL  | NULL          | NULL | NULL    | NULL |    4 | Using where; Using join buffer |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;Impossible-where&quot;&gt;&lt;a href=&quot;#Impossible-where&quot; class=&quot;headerlink&quot; title=&quot;Impossible where&quot;&gt;&lt;/a&gt;Impossible where&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;这个值强调了where语句会导致没有符合条件的行&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; EXPLAIN SELECT * FROM t1 WHERE 1=2;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;result:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+------+---------------+------+---------+------+------+------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra            |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+------+---------------+------+---------+------+------+------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | NULL  | NULL | NULL          | NULL | NULL    | NULL | NULL | Impossible WHERE |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+------+---------------+------+---------+------+------+------------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;Select-tables-optimized-away&quot;&gt;&lt;a href=&quot;#Select-tables-optimized-away&quot; class=&quot;headerlink&quot; title=&quot;Select tables optimized away&quot;&gt;&lt;/a&gt;Select tables optimized away&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;这个值意味着仅通过使用索引,优化器可能仅从聚合函数结果中返回一行.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql&amp;gt; explain select max(id) from t1;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;result:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+------+---------------+------+---------+------+------+------------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra                        |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+------+---------------+------+---------+------+------+------------------------------+&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;|  1 | SIMPLE      | NULL  | NULL | NULL          | NULL | NULL    | NULL | NULL | Select tables optimized away |&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;+----+-------------+-------+------+---------------+------+---------+------+------+------------------------------+&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;Index-merges&quot;&gt;&lt;a href=&quot;#Index-merges&quot; class=&quot;headerlink&quot; title=&quot;Index merges&quot;&gt;&lt;/a&gt;Index merges&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;当MySQL 决定要在一个给定的表上使用超过一个索引的时候,就会出现以下格式中的一个,详细说明使用的索引以及合并的类型。&lt;br&gt;Using sort_union(…)&lt;br&gt;Using union(…)&lt;br&gt;Using intersect(…)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;总结&quot;&gt;&lt;a href=&quot;#总结&quot; class=&quot;headerlink&quot; title=&quot;总结&quot;&gt;&lt;/a&gt;总结&lt;/h2&gt;&lt;p&gt;• EXPLAIN不会告诉你关于触发器,存储过程的信息或用户自定义函数对查询的影响情况&lt;br&gt;• EXPLAIN不考虑各种Cache&lt;br&gt;• EXPLAIN不能显示MySQL在执行查询时所作的优化工作&lt;br&gt;• 部分统计信息是估算的,并非精确值&lt;br&gt;• EXPALIN只能解释SELECT操作,其他操作要重写为SELECT后查看执行计划。&lt;/p&gt;
&lt;h2 id=&quot;更多&quot;&gt;&lt;a href=&quot;#更多&quot; class=&quot;headerlink&quot; title=&quot;更多&quot;&gt;&lt;/a&gt;更多&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://dev.mysql.com/doc/refman/5.5/en/explain-output.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;EXPLAIN Output Columns&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.cnblogs.com/gomysql/p/3720123.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;EXPLAIN 命令详解&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.cnitblog.com/aliyiyi08/archive/2008/09/09/48878.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Mysql Explain 详解&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;今日和同事一起排查一个线上慢sql,温习了遗忘好久的explain,特此记录&lt;/p&gt;
&lt;/blockquote&gt;

    
    </summary>
    
      <category term="学习" scheme="https://zeshawne.github.io/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="rdbms" scheme="https://zeshawne.github.io/tags/rdbms/"/>
    
      <category term="mysql" scheme="https://zeshawne.github.io/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>metaQ + zookeeper</title>
    <link href="https://zeshawne.github.io/2016/08/25/metaQ%20+%20zookeeper/"/>
    <id>https://zeshawne.github.io/2016/08/25/metaQ + zookeeper/</id>
    <published>2016-08-25T15:00:12.000Z</published>
    <updated>2016-09-02T03:04:36.532Z</updated>
    
    <content type="html">&lt;h2 id=&quot;介绍&quot;&gt;&lt;a href=&quot;#介绍&quot; class=&quot;headerlink&quot; title=&quot;介绍&quot;&gt;&lt;/a&gt;介绍&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;metaQ是淘宝开源的一个Java消息中间件,它参考kafka并在其基础上做了许多改进优化.&lt;br&gt;具体介绍请看&lt;a href=&quot;https://github.com/killme2008/Metamorphosis/wiki&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Metamorphosis-wiki&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;下载&quot;&gt;&lt;a href=&quot;#下载&quot; class=&quot;headerlink&quot; title=&quot;下载&quot;&gt;&lt;/a&gt;下载&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://code.google.com/archive/p/meta-queue/downloads&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;点击此处下载metaQ&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;配置&quot;&gt;&lt;a href=&quot;#配置&quot; class=&quot;headerlink&quot; title=&quot;配置&quot;&gt;&lt;/a&gt;配置&lt;/h2&gt;&lt;p&gt;解压下载后的压缩包,其目录结构为:&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;├─bin&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      env.bat&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      env.sh&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      localMetaServer.bat&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      log4j.properties&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      metaServer.bat&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      metaServer.sh&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      tools_log4j.properties&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;├─conf&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      async_slave.properties&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      gregor_slave.properties&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      jettyBroker.properties&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      notifyadaper&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      notifySlave.properties&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      sample.server.ini&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      samsa_master.properties&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      server.ini&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      timetunnel.properties&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;├─lib&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      ...&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      zkclient-0.3.jar&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      zookeeper-3.4.3.jar&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;├─logs&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      metaServer.log&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      slave.log&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      timetunnel.log&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│      transfer.log&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;│&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;└─provided&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        README`&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;通过bin/&lt;code&gt;metaServer.sh&lt;/code&gt;启动服务,主要的配置文件为server.ini,可参考sample.server.ini配置,sample.server.ini有中文注释,解释的比较清楚,就不多啰嗦了.&lt;/p&gt;
&lt;p&gt;默认的server.ini默认配置了一个topic,可以自己添加.&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;;; Topics section&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;[topic=meta-test]&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;确保机器装了JDK并正确设置了&lt;code&gt;JAVA_PATH&lt;/code&gt;和&lt;code&gt;PATH&lt;/code&gt;变量.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;启动服务:&lt;br&gt;bin/metaServer.sh start local&lt;/p&gt;
&lt;p&gt;关闭服务:&lt;br&gt;bin/metaServer.sh stop&lt;/p&gt;
&lt;p&gt;更多:&lt;br&gt;bin/metaServer.sh help&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;windows不支持local模式,需要单独配置zookeeper.&lt;/p&gt;
&lt;h2 id=&quot;集群配置&quot;&gt;&lt;a href=&quot;#集群配置&quot; class=&quot;headerlink&quot; title=&quot;集群配置&quot;&gt;&lt;/a&gt;集群配置&lt;/h2&gt;&lt;h3 id=&quot;zookeeper配置&quot;&gt;&lt;a href=&quot;#zookeeper配置&quot; class=&quot;headerlink&quot; title=&quot;zookeeper配置&quot;&gt;&lt;/a&gt;zookeeper配置&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://zookeeper.apache.org/releases.html#download&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;点击此处下载zookeeper&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;参考conf/&lt;code&gt;server_sample.ini&lt;/code&gt;配置conf/&lt;code&gt;server_.ini&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;Local-metaQ集群配置&quot;&gt;&lt;a href=&quot;#Local-metaQ集群配置&quot; class=&quot;headerlink&quot; title=&quot;Local metaQ集群配置&quot;&gt;&lt;/a&gt;Local metaQ集群配置&lt;/h3&gt;&lt;p&gt;复制metaQ目录到不同目录,更改conf/&lt;code&gt;server.ini&lt;/code&gt;中四个参数:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;serverPort:服务端口&lt;br&gt;dashboardHttpPort:web服务端口&lt;br&gt;dataPath:数据存储路径&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;bin/&lt;code&gt;env.ini&lt;/code&gt;需要修改为不同端口号:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;JMX_PORT:JMX端口号&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;然后启动2个目录下的bin/&lt;code&gt;metaServer.sh&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;Tips&quot;&gt;&lt;a href=&quot;#Tips&quot; class=&quot;headerlink&quot; title=&quot;Tips&quot;&gt;&lt;/a&gt;Tips&lt;/h3&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;配置不成功,请查阅日志追踪错误信息&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;更多&quot;&gt;&lt;a href=&quot;#更多&quot; class=&quot;headerlink&quot; title=&quot;更多&quot;&gt;&lt;/a&gt;更多&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;http://jameswxx.iteye.com/blog/2034111&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;metaq架构原理&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://github.com/killme2008/node-zk-browser&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;node-zk-browser&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;介绍&quot;&gt;&lt;a href=&quot;#介绍&quot; class=&quot;headerlink&quot; title=&quot;介绍&quot;&gt;&lt;/a&gt;介绍&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;metaQ是淘宝开源的一个Java消息中间件,它参考kafka并在其基础上做了许多改进优化.&lt;br&gt;具体介绍请看&lt;
    
    </summary>
    
      <category term="学习" scheme="https://zeshawne.github.io/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="生活" scheme="https://zeshawne.github.io/tags/%E7%94%9F%E6%B4%BB/"/>
    
      <category term="学习" scheme="https://zeshawne.github.io/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
</feed>
