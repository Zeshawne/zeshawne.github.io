<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[metaQ + zookeeper]]></title>
      <url>https://zeshawne.github.io/2016/08/25/metaQ%20+%20zookeeper/</url>
      <content type="html"><![CDATA[<p></p><h2>介绍</h2><p></p>
<blockquote>
<p>metaQ淘宝开源的一个Java消息中间件,它参考kafka并在其基础上做了许多改进优化.<br>具体介绍请看<a href="https://github.com/killme2008/Metamorphosis/wiki" target="_blank" rel="external">Metamorphosis-wiki</a></p>
</blockquote>
<p></p><h2>下载</h2><br><a href="https://code.google.com/archive/p/meta-queue/downloads" target="_blank" rel="external">点击此处下载metaQ</a><p></p>
<p></p><h2>配置</h2><br>解压下载后的压缩包,其目录结构为:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">├─bin</div><div class="line">│      env.bat</div><div class="line">│      env.sh</div><div class="line">│      localMetaServer.bat</div><div class="line">│      log4j.properties</div><div class="line">│      metaServer.bat</div><div class="line">│      metaServer.sh</div><div class="line">│      tools_log4j.properties</div><div class="line">│</div><div class="line">├─conf</div><div class="line">│      async_slave.properties</div><div class="line">│      gregor_slave.properties</div><div class="line">│      jettyBroker.properties</div><div class="line">│      notifyadaper</div><div class="line">│      notifySlave.properties</div><div class="line">│      sample.server.ini</div><div class="line">│      samsa_master.properties</div><div class="line">│      server.ini</div><div class="line">│      timetunnel.properties</div><div class="line">│</div><div class="line">├─lib</div><div class="line">│      ...</div><div class="line">│      zkclient-0.3.jar</div><div class="line">│      zookeeper-3.4.3.jar</div><div class="line">│</div><div class="line">├─logs</div><div class="line">│      metaServer.log</div><div class="line">│      slave.log</div><div class="line">│      timetunnel.log</div><div class="line">│      transfer.log</div><div class="line">│</div><div class="line">└─provided</div><div class="line">        README`</div></pre></td></tr></table></figure><p></p>
<p>通过bin/<code>metaServer.sh</code>启动服务,主要的配置文件为server.ini,可参考sample.server.ini配置,sample.server.ini有中文注释,解释的比较清楚,就不多啰嗦了.</p>
<p>默认的server.ini默认配置了一个topic,可以自己添加.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">;; Topics section</div><div class="line">[topic=meta-test]</div></pre></td></tr></table></figure></p>
<p>确保机器装了JDK并正确设置了<code>JAVA_PATH</code>和<code>PATH</code>变量.</p>
<blockquote>
<p>启动服务:<br>bin/metaServer.sh start local</p>
<p>关闭服务:<br>bin/metaServer.sh stop</p>
<p>更多:<br>bin/metaServer.sh help</p>
</blockquote>
<p>windows不支持local模式,需要单独配置zookeeper.</p>
<p></p><h2>集群配置</h2><p></p>
<p></p><h3>zookeeper配置</h3><br><a href="https://zookeeper.apache.org/releases.html#download" target="_blank" rel="external">点击此处下载zookeeper</a><p></p>
<p>参考conf/<code>server_sample.ini</code>配置conf/<code>server_.ini</code></p>
<p></p><h3>Local metaQ集群配置</h3><br>复制metaQ目录到不同目录,更改conf/<code>server.ini</code>中四个参数:<p></p>
<blockquote>
<p>serverPort:服务端口<br>dashboardHttpPort:web服务端口<br>dataPath:数据存储路径</p>
</blockquote>
<p>bin/<code>env.ini</code>需要修改为不同端口号:</p>
<blockquote>
<p>JMX_PORT:JMX端口号</p>
</blockquote>
<p>然后启动2个目录下的bin/<code>metaServer.sh</code></p>
<p></p><h3>Tips</h3><p></p>
<blockquote>
<ul>
<li>配置不成功,请查阅日志追踪错误信息</li>
</ul>
</blockquote>
<p></p><h2>更多</h2><br><a href="http://jameswxx.iteye.com/blog/2034111" target="_blank" rel="external">metaq架构原理</a><br><a href="https://github.com/killme2008/node-zk-browser" target="_blank" rel="external">node-zk-browser</a><p></p>
]]></content>
    </entry>
    
  
  
</search>
